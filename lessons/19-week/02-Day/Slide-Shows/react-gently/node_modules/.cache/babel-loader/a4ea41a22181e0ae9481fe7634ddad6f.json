{"ast":null,"code":"Object.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _merge2 = require(\"lodash/merge\");\n\nvar _merge3 = _interopRequireDefault(_merge2);\n\nvar _assign2 = require(\"lodash/assign\");\n\nvar _assign3 = _interopRequireDefault(_assign2);\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _jsxFileName = \"src/victory-label/victory-label.js\";\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _victoryPortal = require(\"../victory-portal/victory-portal\");\n\nvar _victoryPortal2 = _interopRequireDefault(_victoryPortal);\n\nvar _propTypes3 = require(\"../victory-util/prop-types\");\n\nvar _propTypes4 = _interopRequireDefault(_propTypes3);\n\nvar _collection = require(\"../victory-util/collection\");\n\nvar _collection2 = _interopRequireDefault(_collection);\n\nvar _helpers = require(\"../victory-util/helpers\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nvar _style = require(\"../victory-util/style\");\n\nvar _style2 = _interopRequireDefault(_style);\n\nvar _log = require(\"../victory-util/log\");\n\nvar _log2 = _interopRequireDefault(_log);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar defaultStyles = {\n  fill: \"#252525\",\n  fontSize: 14,\n  fontFamily: \"'Gill Sans', 'Gill Sans MT', 'SerÂ­avek', 'Trebuchet MS', sans-serif\",\n  stroke: \"transparent\"\n};\n\nvar VictoryLabel = function (_React$Component) {\n  _inherits(VictoryLabel, _React$Component);\n\n  function VictoryLabel() {\n    _classCallCheck(this, VictoryLabel);\n\n    return _possibleConstructorReturn(this, (VictoryLabel.__proto__ || Object.getPrototypeOf(VictoryLabel)).apply(this, arguments));\n  }\n\n  _createClass(VictoryLabel, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.cacheAttributes(this.calculateAttributes(this.props));\n    }\n  }, {\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps) {\n      var attrs = this.calculateAttributes(nextProps);\n      var style = attrs.style,\n          dx = attrs.dx,\n          dy = attrs.dy,\n          content = attrs.content,\n          lineHeight = attrs.lineHeight,\n          textAnchor = attrs.textAnchor,\n          transform = attrs.transform;\n      var _props = this.props,\n          angle = _props.angle,\n          className = _props.className,\n          datum = _props.datum,\n          x = _props.x,\n          y = _props.y;\n\n      if (!_collection2.default.allSetsEqual([[angle, nextProps.angle], [className, nextProps.className], [x, nextProps.x], [y, nextProps.y], [dx, this.dx], [dy, this.dy], [lineHeight, this.lineHeight], [textAnchor, this.textAnchor], [transform, this.transform], [content, this.content], [style, this.style], [datum, nextProps.datum]])) {\n        this.cacheAttributes(attrs);\n        return true;\n      }\n\n      return false;\n    }\n  }, {\n    key: \"cacheAttributes\",\n    value: function cacheAttributes(attrs) {\n      var style = attrs.style,\n          dx = attrs.dx,\n          dy = attrs.dy,\n          content = attrs.content,\n          textAnchor = attrs.textAnchor,\n          transform = attrs.transform,\n          lineHeight = attrs.lineHeight;\n      this.style = style;\n      this.dx = dx;\n      this.dy = dy;\n      this.content = content;\n      this.textAnchor = textAnchor;\n      this.lineHeight = lineHeight;\n      this.transform = transform;\n    }\n  }, {\n    key: \"calculateAttributes\",\n    value: function calculateAttributes(props) {\n      var style = this.getStyles(props);\n      var lineHeight = this.getHeight(props, \"lineHeight\");\n      var textAnchor = props.textAnchor ? _helpers2.default.evaluateProp(props.textAnchor, props.datum) : \"start\";\n      var content = this.getContent(props);\n      var dx = props.dx ? _helpers2.default.evaluateProp(this.props.dx, props.datum) : 0;\n      var dy = this.getDy(props, style, content, lineHeight);\n      var transform = this.getTransform(props, style);\n      return {\n        style: style,\n        dx: dx,\n        dy: dy,\n        content: content,\n        lineHeight: lineHeight,\n        textAnchor: textAnchor,\n        transform: transform\n      };\n    }\n  }, {\n    key: \"getStyle\",\n    value: function getStyle(props, style) {\n      style = style ? (0, _merge3.default)({}, defaultStyles, style) : defaultStyles;\n      var datum = props.datum || props.data;\n\n      var baseStyles = _helpers2.default.evaluateStyle(style, datum, props.active);\n\n      return (0, _assign3.default)({}, baseStyles, {\n        fontSize: this.getFontSize(baseStyles)\n      });\n    }\n  }, {\n    key: \"getStyles\",\n    value: function getStyles(props) {\n      var _this2 = this;\n\n      return Array.isArray(props.style) ? props.style.map(function (style) {\n        return _this2.getStyle(props, style);\n      }) : [this.getStyle(props, props.style)];\n    }\n  }, {\n    key: \"getHeight\",\n    value: function getHeight(props, type) {\n      var datum = props.datum || props.data;\n      return _helpers2.default.evaluateProp(props[type], datum, props.active);\n    }\n  }, {\n    key: \"getContent\",\n    value: function getContent(props) {\n      if (props.text === undefined || props.text === null) {\n        return [\" \"];\n      }\n\n      var datum = props.datum || props.data;\n\n      if (Array.isArray(props.text)) {\n        return props.text.map(function (line) {\n          return _helpers2.default.evaluateProp(line, datum, props.active);\n        });\n      }\n\n      var child = _helpers2.default.evaluateProp(props.text, datum, props.active);\n\n      return (\"\" + child).split(\"\\n\");\n    }\n  }, {\n    key: \"getDy\",\n    value: function getDy(props, style, content, lineHeight) {\n      var fontSize = style[0].fontSize;\n      var datum = props.datum || props.data;\n      var dy = props.dy ? _helpers2.default.evaluateProp(props.dy, datum) : 0;\n      var length = content.length;\n      var capHeight = this.getHeight(props, \"capHeight\");\n      var verticalAnchor = style.verticalAnchor || props.verticalAnchor;\n      var anchor = verticalAnchor ? _helpers2.default.evaluateProp(verticalAnchor, datum) : \"middle\";\n\n      switch (anchor) {\n        case \"end\":\n          return dy + (capHeight / 2 + (0.5 - length) * lineHeight) * fontSize;\n\n        case \"middle\":\n          return dy + (capHeight / 2 + (0.5 - length / 2) * lineHeight) * fontSize;\n\n        default:\n          return dy + (capHeight / 2 + lineHeight / 2) * fontSize;\n      }\n    }\n  }, {\n    key: \"getTransform\",\n    value: function getTransform(props, style) {\n      var datum = props.datum,\n          x = props.x,\n          y = props.y;\n      var angle = style.angle || props.angle;\n      var transform = props.transform || style.transform;\n\n      var transformPart = transform && _helpers2.default.evaluateProp(transform, datum);\n\n      var rotatePart = angle && {\n        rotate: [angle, x, y]\n      };\n      return transformPart || angle ? _style2.default.toTransformString(transformPart, rotatePart) : undefined;\n    }\n  }, {\n    key: \"getFontSize\",\n    value: function getFontSize(style) {\n      var baseSize = style && style.fontSize;\n\n      if (typeof baseSize === \"number\") {\n        return baseSize;\n      } else if (baseSize === undefined || baseSize === null) {\n        return defaultStyles.fontSize;\n      } else if (typeof baseSize === \"string\") {\n        var fontSize = +baseSize.replace(\"px\", \"\");\n\n        if (!isNaN(fontSize)) {\n          return fontSize;\n        } else {\n          _log2.default.warn(\"fontSize should be expressed as a number of pixels\");\n\n          return defaultStyles.fontSize;\n        }\n      }\n\n      return defaultStyles.fontSize;\n    }\n  }, {\n    key: \"renderElements\",\n    value: function renderElements(props) {\n      var _this3 = this;\n\n      var textProps = {\n        dx: this.dx,\n        dy: this.dy,\n        x: props.x,\n        y: props.y,\n        transform: this.transform,\n        className: props.className\n      };\n      return _react2.default.createElement(\"text\", _extends({}, textProps, props.events, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 233\n        }\n      }), this.props.title && _react2.default.createElement(\"title\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        }\n      }, this.props.title), this.props.desc && _react2.default.createElement(\"desc\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237\n        }\n      }, this.props.desc), this.content.map(function (line, i) {\n        var style = _this3.style[i] || _this3.style[0];\n        var lastStyle = _this3.style[i - 1] || _this3.style[0];\n        var fontSize = (style.fontSize + lastStyle.fontSize) / 2;\n        var textAnchor = style.textAnchor || _this3.textAnchor;\n        var dy = i ? _this3.lineHeight * fontSize : undefined;\n        return _react2.default.createElement(\"tspan\", {\n          key: i,\n          x: props.x,\n          dy: dy,\n          dx: _this3.dx,\n          style: style,\n          textAnchor: textAnchor,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 245\n          }\n        }, line);\n      }));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var label = this.renderElements(this.props);\n      return this.props.renderInPortal ? _react2.default.createElement(_victoryPortal2.default, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256\n        }\n      }, label) : label;\n    }\n  }]);\n\n  return VictoryLabel;\n}(_react2.default.Component);\n\nVictoryLabel.displayName = \"VictoryLabel\";\nVictoryLabel.role = \"label\";\nVictoryLabel.propTypes = {\n  active: _propTypes2.default.bool,\n  angle: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.number]),\n  capHeight: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes4.default.nonNegative, _propTypes2.default.func]),\n  className: _propTypes2.default.string,\n  data: _propTypes2.default.array,\n  datum: _propTypes2.default.any,\n  desc: _propTypes2.default.string,\n  dx: _propTypes2.default.oneOfType([_propTypes2.default.number, _propTypes2.default.string, _propTypes2.default.func]),\n  dy: _propTypes2.default.oneOfType([_propTypes2.default.number, _propTypes2.default.string, _propTypes2.default.func]),\n  events: _propTypes2.default.object,\n  index: _propTypes2.default.oneOfType([_propTypes2.default.number, _propTypes2.default.string]),\n  lineHeight: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes4.default.nonNegative, _propTypes2.default.func]),\n  renderInPortal: _propTypes2.default.bool,\n  style: _propTypes2.default.oneOfType([_propTypes2.default.object, _propTypes2.default.array]),\n  text: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.number, _propTypes2.default.func, _propTypes2.default.array]),\n  textAnchor: _propTypes2.default.oneOfType([_propTypes2.default.oneOf([\"start\", \"middle\", \"end\", \"inherit\"]), _propTypes2.default.func]),\n  title: _propTypes2.default.string,\n  transform: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.object, _propTypes2.default.func]),\n  verticalAnchor: _propTypes2.default.oneOfType([_propTypes2.default.oneOf([\"start\", \"middle\", \"end\"]), _propTypes2.default.func]),\n  x: _propTypes2.default.number,\n  y: _propTypes2.default.number\n};\nVictoryLabel.defaultProps = {\n  capHeight: 0.71,\n  lineHeight: 1\n};\nexports.default = VictoryLabel;","map":null,"metadata":{},"sourceType":"script"}