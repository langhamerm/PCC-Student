{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _getOwnPropertyDescriptor = require('babel-runtime/core-js/object/get-own-property-descriptor');\n\nvar _getOwnPropertyDescriptor2 = _interopRequireDefault(_getOwnPropertyDescriptor);\n\nvar _jsx2 = require('babel-runtime/helpers/jsx');\n\nvar _jsx3 = _interopRequireDefault(_jsx2);\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _class, _desc, _value, _class2;\n/* eslint-disable no-invalid-this */\n\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _isUndefined = require('lodash/isUndefined');\n\nvar _isUndefined2 = _interopRequireDefault(_isUndefined);\n\nvar _base = require('../utils/base');\n\nvar _radium = require('radium');\n\nvar _radium2 = _interopRequireDefault(_radium);\n\nvar _actions = require('../actions');\n\nvar _transitionable = require('./transitionable');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _applyDecoratedDescriptor(target, property, decorators, descriptor, context) {\n  var desc = {};\n  Object['ke' + 'ys'](descriptor).forEach(function (key) {\n    desc[key] = descriptor[key];\n  });\n  desc.enumerable = !!desc.enumerable;\n  desc.configurable = !!desc.configurable;\n\n  if ('value' in desc || desc.initializer) {\n    desc.writable = true;\n  }\n\n  desc = decorators.slice().reverse().reduce(function (desc, decorator) {\n    return decorator(target, property, desc) || desc;\n  }, desc);\n\n  if (context && desc.initializer !== void 0) {\n    desc.value = desc.initializer ? desc.initializer.call(context) : void 0;\n    desc.initializer = undefined;\n  }\n\n  if (desc.initializer === void 0) {\n    Object['define' + 'Property'](target, property, desc);\n    desc = null;\n  }\n\n  return desc;\n}\n\nvar Slide = (0, _transitionable.Transitionable)(_class = (0, _radium2.default)(_class = (_class2 = function (_React$PureComponent) {\n  (0, _inherits3.default)(Slide, _React$PureComponent);\n\n  function Slide() {\n    var _temp, _this, _ret;\n\n    (0, _classCallCheck3.default)(this, Slide);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = (0, _possibleConstructorReturn3.default)(this, _React$PureComponent.call.apply(_React$PureComponent, [this].concat(args))), _this), _this.state = {\n      contentScale: 1,\n      transitioning: true,\n      z: 1,\n      zoom: 1\n    }, _this.setZoom = function () {\n      var mobile = window.matchMedia('(max-width: 628px)').matches;\n      var content = _this.contentRef;\n\n      if (content) {\n        var zoom = _this.props.viewerScaleMode ? 1 : content.offsetWidth / _this.context.contentWidth;\n        var contentScaleY = content.parentNode.offsetHeight / _this.context.contentHeight;\n        var contentScaleX = _this.props.viewerScaleMode ? content.parentNode.offsetWidth / _this.context.contentWidth : content.parentNode.offsetWidth / _this.context.contentHeight;\n        var minScale = Math.min(contentScaleY, contentScaleX);\n        var contentScale = minScale < 1 ? minScale : 1;\n\n        if (mobile && _this.props.viewerScaleMode !== true) {\n          contentScale = 1;\n        }\n\n        _this.setState({\n          zoom: zoom > 0.6 ? zoom : 0.6,\n          contentScale: contentScale\n        });\n      }\n    }, _temp), (0, _possibleConstructorReturn3.default)(_this, _ret);\n  }\n\n  Slide.prototype.getChildContext = function getChildContext() {\n    return {\n      slideHash: this.props.hash\n    };\n  };\n\n  Slide.prototype.componentDidMount = function componentDidMount() {\n    var _this2 = this;\n\n    this.setZoom();\n    var slide = this.slideRef;\n    var frags = slide.querySelectorAll('.fragment');\n\n    if (frags && frags.length && !this.context.overview) {\n      Array.prototype.slice.call(frags, 0).forEach(function (frag, i) {\n        frag.dataset.fid = i;\n        return _this2.props.dispatch && _this2.props.dispatch((0, _actions.addFragment)({\n          slide: _this2.props.hash,\n          id: i,\n          visible: _this2.props.lastSlideIndex > _this2.props.slideIndex\n        }));\n      });\n    }\n\n    window.addEventListener('load', this.setZoom);\n    window.addEventListener('resize', this.setZoom);\n  };\n\n  Slide.prototype.componentWillUnmount = function componentWillUnmount() {\n    window.removeEventListener('resize', this.setZoom);\n  };\n\n  Slide.prototype.allStyles = function allStyles() {\n    var _props = this.props,\n        align = _props.align,\n        print = _props.print;\n    var styles = {\n      outer: (0, _extends3.default)({\n        position: this.props.export ? 'relative' : 'absolute',\n        top: 0,\n        left: 0,\n        width: '100%',\n        height: '100%',\n        display: 'flex',\n        overflow: 'hidden',\n        backgroundColor: this.context.styles.global.body.background ? this.context.styles.global.body.background : ''\n      }, this.props.style),\n      inner: {\n        display: 'flex',\n        position: 'relative',\n        flex: 1,\n        alignItems: align ? align.split(' ')[1] : 'center',\n        justifyContent: align ? align.split(' ')[0] : 'center'\n      },\n      content: {\n        flex: 1,\n        maxHeight: this.context.contentHeight || 700,\n        maxWidth: this.context.contentWidth || 1000,\n        transform: 'scale(' + this.state.contentScale + ')',\n        padding: this.state.zoom > 0.6 ? this.props.margin || 40 : 10\n      }\n    };\n    var overViewStyles = {\n      inner: {\n        flexDirection: 'column'\n      },\n      content: {\n        width: '100%'\n      }\n    };\n    var printStyles = print ? {\n      backgroundColor: 'white',\n      backgroundImage: 'none'\n    } : {};\n    return {\n      styles: styles,\n      overViewStyles: overViewStyles,\n      printStyles: printStyles\n    };\n  };\n\n  Slide.prototype.render = function render() {\n    var _this3 = this;\n\n    var _props2 = this.props,\n        presenterStyle = _props2.presenterStyle,\n        children = _props2.children;\n\n    var _allStyles = this.allStyles(),\n        styles = _allStyles.styles,\n        overViewStyles = _allStyles.overViewStyles,\n        printStyles = _allStyles.printStyles;\n\n    if (!this.props.viewerScaleMode) {\n      document.documentElement.style.fontSize = 16 * this.state.zoom + 'px';\n    }\n\n    var contentClass = (0, _isUndefined2.default)(this.props.className) ? '' : this.props.className;\n    return _react2.default.createElement('div', {\n      className: 'spectacle-slide',\n      ref: function ref(s) {\n        _this3.slideRef = s;\n      },\n      style: [styles.outer, _base.getStyles.call(this), printStyles, presenterStyle]\n    }, (0, _jsx3.default)('div', {\n      style: [styles.inner, this.context.overview && overViewStyles.inner]\n    }, void 0, _react2.default.createElement('div', {\n      ref: function ref(c) {\n        _this3.contentRef = c;\n      },\n      className: contentClass + ' spectacle-content',\n      style: [styles.content, this.context.styles.components.content, this.context.overview && overViewStyles.content]\n    }, children)));\n  };\n\n  return Slide;\n}(_react2.default.PureComponent), _applyDecoratedDescriptor(_class2.prototype, 'render', [_transitionable.renderTransition], (0, _getOwnPropertyDescriptor2.default)(_class2.prototype, 'render'), _class2.prototype), _class2)) || _class) || _class;\n\nSlide.defaultProps = {\n  align: 'center center',\n  presenterStyle: {},\n  style: {},\n  viewerScaleMode: false\n};\nSlide.contextTypes = {\n  styles: _propTypes2.default.object,\n  contentWidth: _propTypes2.default.number,\n  contentHeight: _propTypes2.default.number,\n  export: _propTypes2.default.bool,\n  print: _propTypes2.default.object,\n  overview: _propTypes2.default.bool,\n  store: _propTypes2.default.object\n};\nSlide.childContextTypes = {\n  slideHash: _propTypes2.default.oneOfType([_propTypes2.default.number, _propTypes2.default.string])\n};\nexports.default = Slide;","map":null,"metadata":{},"sourceType":"script"}