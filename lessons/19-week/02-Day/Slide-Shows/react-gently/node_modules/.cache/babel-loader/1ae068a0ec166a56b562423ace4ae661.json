{"ast":null,"code":"Object.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _sortBy2 = require(\"lodash/sortBy\");\n\nvar _sortBy3 = _interopRequireDefault(_sortBy2);\n\nvar _property2 = require(\"lodash/property\");\n\nvar _property3 = _interopRequireDefault(_property2);\n\nvar _isFunction2 = require(\"lodash/isFunction\");\n\nvar _isFunction3 = _interopRequireDefault(_isFunction2);\n\nvar _last2 = require(\"lodash/last\");\n\nvar _last3 = _interopRequireDefault(_last2);\n\nvar _range2 = require(\"lodash/range\");\n\nvar _range3 = _interopRequireDefault(_range2);\n\nvar _uniq2 = require(\"lodash/uniq\");\n\nvar _uniq3 = _interopRequireDefault(_uniq2);\n\nvar _assign2 = require(\"lodash/assign\");\n\nvar _assign3 = _interopRequireDefault(_assign2);\n\nvar _helpers = require(\"./helpers\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nvar _collection = require(\"./collection\");\n\nvar _collection2 = _interopRequireDefault(_collection);\n\nvar _scale = require(\"./scale\");\n\nvar _scale2 = _interopRequireDefault(_scale);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n}\n\nexports.default = {\n  getData: function getData(props) {\n    var data = void 0;\n\n    if (props.data) {\n      if (props.data.length < 1) {\n        return [];\n      } else {\n        data = this.formatData(props.data, props);\n      }\n    } else {\n      data = this.formatData(this.generateData(props), props);\n    }\n\n    return this.addEventKeys(props, data);\n  },\n  generateDataArray: function generateDataArray(props, axis) {\n    var propsDomain = props.domain && Array.isArray(props.domain) ? props.domain : props.domain && props.domain[axis];\n\n    var domain = propsDomain || _scale2.default.getBaseScale(props, axis).domain();\n\n    var samples = props.samples || 1;\n    var domainMax = Math.max.apply(Math, _toConsumableArray(domain));\n    var domainMin = Math.min.apply(Math, _toConsumableArray(domain));\n    var step = (domainMax - domainMin) / samples;\n    var values = (0, _range3.default)(domainMin, domainMax, step);\n    return (0, _last3.default)(values) === domainMax ? values : values.concat(domainMax);\n  },\n  generateData: function generateData(props) {\n    var xValues = this.generateDataArray(props, \"x\");\n    var yValues = this.generateDataArray(props, \"y\");\n    var values = xValues.map(function (x, i) {\n      return {\n        x: x,\n        y: yValues[i]\n      };\n    });\n    return values;\n  },\n  formatData: function formatData(dataset, props, stringMap) {\n    if (!Array.isArray(dataset)) {\n      return [];\n    }\n\n    stringMap = stringMap || {\n      x: this.createStringMap(props, \"x\"),\n      y: this.createStringMap(props, \"y\")\n    };\n    var accessor = {\n      x: _helpers2.default.createAccessor(props.x !== undefined ? props.x : \"x\"),\n      y: _helpers2.default.createAccessor(props.y !== undefined ? props.y : \"y\"),\n      y0: _helpers2.default.createAccessor(props.y0 !== undefined ? props.y0 : \"y0\")\n    };\n    var data = dataset.map(function (datum, index) {\n      var evaluatedX = datum._x !== undefined ? datum._x : accessor.x(datum);\n      var evaluatedY = datum._y !== undefined ? datum._y : accessor.y(datum);\n      var y0 = datum._y0 !== undefined ? datum._y0 : accessor.y0(datum);\n      var x = evaluatedX !== undefined ? evaluatedX : index;\n      var y = evaluatedY !== undefined ? evaluatedY : datum;\n      var originalValues = y0 === undefined ? {\n        x: x,\n        y: y\n      } : {\n        x: x,\n        y: y,\n        y0: y0\n      };\n      var privateValues = y0 === undefined ? {\n        _x: x,\n        _y: y\n      } : {\n        _x: x,\n        _y: y,\n        _y0: y0\n      };\n      return (0, _assign3.default)(originalValues, datum, privateValues, typeof x === \"string\" ? {\n        _x: stringMap.x[x],\n        xName: x\n      } : {}, typeof y === \"string\" ? {\n        _y: stringMap.y[y],\n        yName: y\n      } : {}, typeof y0 === \"string\" ? {\n        _y0: stringMap.y[y0],\n        yName: y0\n      } : {});\n    });\n    var sortedData = this.sortData(data, props.sortKey);\n    return this.cleanData(sortedData, props);\n  },\n  sortData: function sortData(dataset, sortKey) {\n    if (!sortKey) {\n      return dataset;\n    }\n\n    if (sortKey === \"x\" || sortKey === \"y\") {\n      sortKey = \"_\" + sortKey;\n    }\n\n    return (0, _sortBy3.default)(dataset, sortKey);\n  },\n  cleanData: function cleanData(dataset, props) {\n    var scaleType = {\n      x: _scale2.default.getScaleType(props, \"x\"),\n      y: _scale2.default.getScaleType(props, \"y\")\n    };\n\n    if (scaleType.x !== \"log\" && scaleType.y !== \"log\") {\n      return dataset;\n    }\n\n    var rules = function rules(datum, axis) {\n      return scaleType[axis] === \"log\" ? datum[\"_\" + axis] !== 0 : true;\n    };\n\n    return dataset.filter(function (datum) {\n      return rules(datum, \"x\") && rules(datum, \"y\") && rules(datum, \"y0\");\n    });\n  },\n  getEventKey: function getEventKey(key) {\n    if ((0, _isFunction3.default)(key)) {\n      return key;\n    } else if (key === null || typeof key === \"undefined\") {\n      return function () {\n        return undefined;\n      };\n    }\n\n    return (0, _property3.default)(key);\n  },\n  addEventKeys: function addEventKeys(props, data) {\n    var eventKeyAccessor = this.getEventKey(props.eventKey);\n    return data.map(function (datum, index) {\n      var eventKey = datum.eventKey || eventKeyAccessor(datum) || index;\n      return (0, _assign3.default)({\n        eventKey: eventKey\n      }, datum);\n    });\n  },\n  createStringMap: function createStringMap(props, axis) {\n    var stringsFromAxes = this.getStringsFromAxes(props, axis);\n    var stringsFromCategories = this.getStringsFromCategories(props, axis);\n    var stringsFromData = this.getStringsFromData(props, axis);\n    var allStrings = (0, _uniq3.default)([].concat(_toConsumableArray(stringsFromAxes), _toConsumableArray(stringsFromCategories), _toConsumableArray(stringsFromData)));\n    return allStrings.length === 0 ? null : allStrings.reduce(function (memo, string, index) {\n      memo[string] = index + 1;\n      return memo;\n    }, {});\n  },\n  getStringsFromData: function getStringsFromData(props, axis) {\n    if (!Array.isArray(props.data)) {\n      return [];\n    }\n\n    var key = typeof props[axis] === \"undefined\" ? axis : props[axis];\n\n    var accessor = _helpers2.default.createAccessor(key);\n\n    var dataStrings = props.data.map(function (datum) {\n      return accessor(datum);\n    }).filter(function (datum) {\n      return typeof datum === \"string\";\n    });\n    return dataStrings.reduce(function (prev, curr) {\n      if (typeof curr !== \"undefined\" && curr !== null && prev.indexOf(curr) === -1) {\n        prev.push(curr);\n      }\n\n      return prev;\n    }, []);\n  },\n  getStringsFromAxes: function getStringsFromAxes(props, axis) {\n    if (!props.tickValues || !Array.isArray(props.tickValues) && !props.tickValues[axis]) {\n      return [];\n    }\n\n    var tickValueArray = props.tickValues[axis] || props.tickValues;\n    return tickValueArray.filter(function (val) {\n      return typeof val === \"string\";\n    });\n  },\n  getStringsFromCategories: function getStringsFromCategories(props, axis) {\n    if (!props.categories) {\n      return [];\n    }\n\n    var categories = this.getCategories(props, axis);\n    var categoryStrings = categories && categories.filter(function (val) {\n      return typeof val === \"string\";\n    });\n    return categoryStrings ? _collection2.default.removeUndefined(categoryStrings) : [];\n  },\n  getCategories: function getCategories(props, axis) {\n    return props.categories && !Array.isArray(props.categories) ? props.categories[axis] : props.categories;\n  }\n};","map":null,"metadata":{},"sourceType":"script"}