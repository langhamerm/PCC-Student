{"ast":null,"code":"Object.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _maxBy2 = require(\"lodash/maxBy\");\n\nvar _maxBy3 = _interopRequireDefault(_maxBy2);\n\nvar _sumBy2 = require(\"lodash/sumBy\");\n\nvar _sumBy3 = _interopRequireDefault(_sumBy2);\n\nvar _defaults2 = require(\"lodash/defaults\");\n\nvar _defaults3 = _interopRequireDefault(_defaults2);\n\nvar _isEmpty2 = require(\"lodash/isEmpty\");\n\nvar _isEmpty3 = _interopRequireDefault(_isEmpty2);\n\nvar _merge2 = require(\"lodash/merge\");\n\nvar _merge3 = _interopRequireDefault(_merge2);\n\nvar _jsxFileName = \"src/victory-legend/victory-legend.js\";\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _propTypes3 = require(\"../victory-util/prop-types\");\n\nvar _propTypes4 = _interopRequireDefault(_propTypes3);\n\nvar _style = require(\"../victory-util/style\");\n\nvar _style2 = _interopRequireDefault(_style);\n\nvar _textsize = require(\"../victory-util/textsize\");\n\nvar _textsize2 = _interopRequireDefault(_textsize);\n\nvar _helpers = require(\"../victory-util/helpers\");\n\nvar _helpers2 = _interopRequireDefault(_helpers);\n\nvar _victoryLabel = require(\"../victory-label/victory-label\");\n\nvar _victoryLabel2 = _interopRequireDefault(_victoryLabel);\n\nvar _victoryContainer = require(\"../victory-container/victory-container\");\n\nvar _victoryContainer2 = _interopRequireDefault(_victoryContainer);\n\nvar _victoryTheme = require(\"../victory-theme/victory-theme\");\n\nvar _victoryTheme2 = _interopRequireDefault(_victoryTheme);\n\nvar _point = require(\"../victory-primitives/point\");\n\nvar _point2 = _interopRequireDefault(_point);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar defaultLegendData = [{\n  name: \"Series 1\"\n}, {\n  name: \"Series 2\"\n}];\n\nvar VictoryLegend = function (_React$Component) {\n  _inherits(VictoryLegend, _React$Component);\n\n  function VictoryLegend() {\n    _classCallCheck(this, VictoryLegend);\n\n    return _possibleConstructorReturn(this, (VictoryLegend.__proto__ || Object.getPrototypeOf(VictoryLegend)).apply(this, arguments));\n  }\n\n  _createClass(VictoryLegend, [{\n    key: \"calculateLegendHeight\",\n    value: function calculateLegendHeight(textSizes, padding, isHorizontal) {\n      var _props = this.props,\n          gutter = _props.gutter,\n          itemsPerRow = _props.itemsPerRow;\n      var itemCount = textSizes.length;\n      var rowCount = itemsPerRow ? Math.ceil(itemCount / itemsPerRow) : 1;\n      var contentHeight = isHorizontal ? (0, _maxBy3.default)(textSizes, \"height\").height * rowCount + gutter * (rowCount - 1) : ((0, _sumBy3.default)(textSizes, \"height\") + gutter * (itemCount - 1)) / rowCount;\n      return padding.top + contentHeight + padding.bottom;\n    }\n  }, {\n    key: \"calculateLegendWidth\",\n    value: function calculateLegendWidth(itemCount, padding, isHorizontal, maxTextWidth) {\n      var _props2 = this.props,\n          gutter = _props2.gutter,\n          itemsPerRow = _props2.itemsPerRow,\n          symbolSpacer = _props2.symbolSpacer;\n      var rowCount = itemsPerRow ? Math.ceil(itemCount / itemsPerRow) : 1;\n      var rowItemCount = itemsPerRow || itemCount;\n      var contentWidth = void 0;\n\n      if (isHorizontal) {\n        var gutterWidth = gutter * rowItemCount;\n        var symbolWidth = symbolSpacer * 3 * rowItemCount;\n        var textWidth = maxTextWidth * rowItemCount;\n        contentWidth = symbolWidth + textWidth + gutterWidth;\n      } else {\n        contentWidth = (maxTextWidth + symbolSpacer * 2 + gutter) * rowCount;\n      }\n\n      return padding.left + contentWidth + padding.right;\n    }\n  }, {\n    key: \"getColorScale\",\n    value: function getColorScale(theme) {\n      var colorScaleOptions = this.props.colorScale || theme.colorScale;\n\n      if (typeof colorScaleOptions === \"string\") {\n        colorScaleOptions = _style2.default.getColorScale(colorScaleOptions);\n      }\n\n      return !(0, _isEmpty3.default)(theme) ? colorScaleOptions || theme.colorScale : colorScaleOptions || [];\n    }\n  }, {\n    key: \"getCalculatedProps\",\n    value: function getCalculatedProps() {\n      var _this2 = this;\n\n      var role = this.constructor.role;\n      var _props3 = this.props,\n          data = _props3.data,\n          orientation = _props3.orientation,\n          theme = _props3.theme;\n      var legendTheme = theme && theme[role] ? theme[role] : {};\n      var parentStyles = this.getStyles({}, legendTheme, \"parent\");\n      var colorScale = this.getColorScale(legendTheme);\n      var isHorizontal = orientation === \"horizontal\";\n      var symbolStyles = [];\n      var labelStyles = [];\n      var _props4 = this.props,\n          height = _props4.height,\n          padding = _props4.padding,\n          width = _props4.width;\n      var maxTextWidth = 0;\n      padding = _helpers2.default.getPadding({\n        padding: padding || theme.padding\n      });\n      height = _helpers2.default.evaluateProp(height || theme.height, data);\n      width = _helpers2.default.evaluateProp(width || theme.width, data);\n      var textSizes = data.map(function (datum, i) {\n        var labelStyle = _this2.getStyles(datum, legendTheme, \"labels\");\n\n        var textSize = _textsize2.default.approximateTextSize(datum.name, labelStyle);\n\n        maxTextWidth = textSize.width > maxTextWidth ? textSize.width : maxTextWidth;\n        symbolStyles[i] = _this2.getStyles(datum, legendTheme, \"symbol\", colorScale[i]);\n        labelStyles[i] = labelStyle;\n        return textSize;\n      });\n\n      if (!height) {\n        height = this.calculateLegendHeight(textSizes, padding, isHorizontal);\n      }\n\n      if (!width) {\n        width = this.calculateLegendWidth(textSizes.length, padding, isHorizontal, maxTextWidth);\n      }\n\n      return _extends({}, this.props, {\n        isHorizontal: isHorizontal,\n        height: height,\n        labelStyles: labelStyles,\n        maxTextWidth: maxTextWidth,\n        padding: padding,\n        parentStyles: parentStyles,\n        symbolStyles: symbolStyles,\n        width: width\n      });\n    }\n  }, {\n    key: \"getStyles\",\n    value: function getStyles(datum, theme, key, color) {\n      var style = this.props.style;\n      var styleKey = key === \"symbol\" ? \"data\" : key;\n      var colorScaleStyle = color ? {\n        fill: color\n      } : {};\n      var styles = (0, _merge3.default)({}, theme.style[styleKey], colorScaleStyle, style[styleKey], datum[key]);\n      return _helpers2.default.evaluateStyle(styles, datum);\n    }\n  }, {\n    key: \"getSymbolSize\",\n    value: function getSymbolSize(datum, fontSize) {\n      return datum.symbol && datum.symbol.size ? datum.symbol.size : fontSize / 2.5;\n    }\n  }, {\n    key: \"getSymbolProps\",\n    value: function getSymbolProps(datum, props, i) {\n      var dataComponent = props.dataComponent,\n          gutter = props.gutter,\n          isHorizontal = props.isHorizontal,\n          itemsPerRow = props.itemsPerRow,\n          labelStyles = props.labelStyles,\n          maxTextWidth = props.maxTextWidth,\n          padding = props.padding,\n          symbolSpacer = props.symbolSpacer,\n          symbolStyles = props.symbolStyles;\n      var fontSize = labelStyles[i].fontSize;\n      var symbolShift = fontSize / 2;\n      var style = symbolStyles[i];\n      var rowHeight = fontSize + gutter;\n      var itemIndex = i;\n      var rowSpacer = 0;\n      var rowIndex = 0;\n\n      if (itemsPerRow) {\n        rowIndex = Math.floor(i / itemsPerRow);\n        rowSpacer = rowHeight * rowIndex;\n        itemIndex = i % itemsPerRow;\n      }\n\n      var symbolCoords = isHorizontal ? {\n        x: padding.left + symbolShift + (fontSize + symbolSpacer + maxTextWidth + gutter) * itemIndex,\n        y: padding.top + symbolShift + rowSpacer\n      } : {\n        x: padding.left + symbolShift + (rowHeight + maxTextWidth) * rowIndex,\n        y: padding.top + symbolShift + rowHeight * itemIndex\n      };\n      return (0, _defaults3.default)({}, dataComponent.props, _extends({\n        key: \"symbol-\" + i,\n        style: style,\n        size: this.getSymbolSize(datum, fontSize),\n        symbol: style.type\n      }, symbolCoords));\n    }\n  }, {\n    key: \"getLabelProps\",\n    value: function getLabelProps(datum, props, i) {\n      var gutter = props.gutter,\n          isHorizontal = props.isHorizontal,\n          itemsPerRow = props.itemsPerRow,\n          labelComponent = props.labelComponent,\n          labelStyles = props.labelStyles,\n          maxTextWidth = props.maxTextWidth,\n          padding = props.padding,\n          symbolSpacer = props.symbolSpacer;\n      var style = labelStyles[i];\n      var fontSize = style.fontSize;\n      var symbolShift = fontSize / 2;\n      var rowHeight = fontSize + gutter;\n      var symbolWidth = fontSize + symbolSpacer;\n      var itemIndex = i;\n      var rowSpacer = 0;\n      var rowIndex = 0;\n\n      if (itemsPerRow) {\n        rowIndex = Math.floor(i / itemsPerRow);\n        rowSpacer = rowHeight * rowIndex;\n        itemIndex = i % itemsPerRow;\n      }\n\n      var labelCoords = isHorizontal ? {\n        x: padding.left + symbolWidth * (itemIndex + 1) + (maxTextWidth + gutter) * itemIndex,\n        y: padding.top + symbolShift + rowSpacer\n      } : {\n        x: padding.left + symbolWidth + (rowHeight + maxTextWidth) * rowIndex,\n        y: padding.top + symbolShift + rowHeight * itemIndex\n      };\n      return (0, _defaults3.default)({}, labelComponent.props, _extends({\n        key: \"label-\" + i,\n        style: style,\n        text: datum.name\n      }, labelCoords));\n    }\n  }, {\n    key: \"renderLegendItems\",\n    value: function renderLegendItems(props) {\n      var _this3 = this;\n\n      var data = props.data,\n          dataComponent = props.dataComponent,\n          labelComponent = props.labelComponent;\n      var legendData = (0, _isEmpty3.default)(data) ? defaultLegendData : data;\n      var dataComponents = legendData.map(function (datum, i) {\n        return _react2.default.cloneElement(dataComponent, _this3.getSymbolProps(datum, props, i));\n      });\n      var labelComponents = legendData.map(function (datum, i) {\n        return _react2.default.cloneElement(labelComponent, _this3.getLabelProps(datum, props, i));\n      });\n      return [].concat(_toConsumableArray(dataComponents), _toConsumableArray(labelComponents));\n    }\n  }, {\n    key: \"renderGroup\",\n    value: function renderGroup(props, children) {\n      var groupComponent = props.groupComponent,\n          height = props.height,\n          parentStyles = props.parentStyles,\n          standalone = props.standalone,\n          width = props.width,\n          x = props.x,\n          y = props.y;\n      var groupProps = {\n        role: \"presentation\"\n      };\n\n      if (!standalone) {\n        groupProps = _extends({\n          height: height,\n          width: width,\n          transform: \"translate(\" + x + \", \" + y + \")\",\n          style: parentStyles\n        }, groupProps);\n      }\n\n      return _react2.default.cloneElement(groupComponent, groupProps, children);\n    }\n  }, {\n    key: \"renderContainer\",\n    value: function renderContainer(props, children) {\n      var containerComponent = props.containerComponent,\n          height = props.height,\n          parentStyles = props.parentStyles,\n          width = props.width;\n      return _react2.default.cloneElement(containerComponent, {\n        height: height,\n        width: width,\n        style: parentStyles\n      }, children);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var props = this.getCalculatedProps();\n      var group = this.renderGroup(props, this.renderLegendItems(props));\n      return props.standalone ? this.renderContainer(props, group) : group;\n    }\n  }]);\n\n  return VictoryLegend;\n}(_react2.default.Component);\n\nVictoryLegend.displayName = \"VictoryLegend\";\nVictoryLegend.role = \"legend\";\nVictoryLegend.propTypes = {\n  colorScale: _propTypes2.default.oneOfType([_propTypes2.default.arrayOf(_propTypes2.default.string), _propTypes2.default.oneOf([\"grayscale\", \"qualitative\", \"heatmap\", \"warm\", \"cool\", \"red\", \"green\", \"blue\"])]),\n  containerComponent: _propTypes2.default.element,\n  data: _propTypes2.default.arrayOf(_propTypes2.default.shape({\n    name: _propTypes2.default.string.isRequired,\n    label: _propTypes2.default.object,\n    symbol: _propTypes2.default.object\n  })),\n  dataComponent: _propTypes2.default.element,\n  groupComponent: _propTypes2.default.element,\n  gutter: _propTypes2.default.number,\n  height: _propTypes2.default.oneOfType([_propTypes4.default.nonNegative, _propTypes2.default.func]),\n  itemsPerRow: _propTypes2.default.number,\n  labelComponent: _propTypes2.default.element,\n  orientation: _propTypes2.default.oneOf([\"horizontal\", \"vertical\"]),\n  padding: _propTypes2.default.oneOfType([_propTypes2.default.number, _propTypes2.default.shape({\n    top: _propTypes2.default.number,\n    bottom: _propTypes2.default.number,\n    left: _propTypes2.default.number,\n    right: _propTypes2.default.number\n  })]),\n  standalone: _propTypes2.default.bool,\n  style: _propTypes2.default.shape({\n    data: _propTypes2.default.object,\n    labels: _propTypes2.default.object,\n    parent: _propTypes2.default.object\n  }),\n  symbolSpacer: _propTypes2.default.number,\n  theme: _propTypes2.default.object,\n  width: _propTypes2.default.oneOfType([_propTypes4.default.nonNegative, _propTypes2.default.func]),\n  x: _propTypes2.default.number,\n  y: _propTypes2.default.number\n};\nVictoryLegend.defaultProps = {\n  data: defaultLegendData,\n  containerComponent: _react2.default.createElement(_victoryContainer2.default, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    }\n  }),\n  dataComponent: _react2.default.createElement(_point2.default, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    }\n  }),\n  groupComponent: _react2.default.createElement(\"g\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    }\n  }),\n  gutter: 10,\n  labelComponent: _react2.default.createElement(_victoryLabel2.default, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    }\n  }),\n  orientation: \"vertical\",\n  standalone: true,\n  style: {},\n  symbolSpacer: 8,\n  theme: _victoryTheme2.default.grayscale,\n  x: 0,\n  y: 0\n};\nexports.default = VictoryLegend;","map":null,"metadata":{},"sourceType":"script"}